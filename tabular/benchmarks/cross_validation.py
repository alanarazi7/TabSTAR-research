from typing import List

from tabular.datasets.tabular_datasets import OpenMLDatasetID, UrlDatasetID, KaggleDatasetID, TabularDatasetID
ALL_TEXT_SHUFFLED = [
    KaggleDatasetID.REG_SOCIAL_ANIME_PLANET_RATING,
    KaggleDatasetID.REG_FOOD_RAMEN_RATINGS_2022,
    UrlDatasetID.REG_CONSUMER_BIKE_PRICE_BIKEWALE,
    KaggleDatasetID.REG_SOCIAL_BOOK_READABILITY_CLEAR,
    KaggleDatasetID.REG_FOOD_ZOMATO_RESTAURANTS,
    OpenMLDatasetID.REG_CONSUMER_JC_PENNEY_PRODUCT_PRICE,
    KaggleDatasetID.REG_SOCIAL_FILMTV_MOVIE_RATING_ITALY,
    KaggleDatasetID.REG_TRANSPORTATION_USED_CAR_PAKISTAN,
    OpenMLDatasetID.MUL_SOCIAL_GOOGLE_QA_TYPE_REASON,
    UrlDatasetID.REG_SOCIAL_MOVIES_ROTTEN_TOMATOES,
    OpenMLDatasetID.MUL_CONSUMER_PRODUCT_SENTIMENT,
    OpenMLDatasetID.REG_CONSUMER_AMERICAN_EAGLE_PRICES,
    OpenMLDatasetID.MUL_HOUSES_MELBOURNE_AIRBNB,
    KaggleDatasetID.REG_SOCIAL_VIDEO_GAMES_SALES,
    KaggleDatasetID.REG_CONSUMER_CAR_PRICE_CARDEKHO,
    OpenMLDatasetID.MUL_SOCIAL_NEWS_CHANNEL_CATEGORY,
    OpenMLDatasetID.REG_PROFESSIONAL_EMPLOYEE_SALARY_MONTGOMERY,
    OpenMLDatasetID.BIN_PROFESSIONAL_KICKSTARTER_FUNDING,
    KaggleDatasetID.REG_SOCIAL_MOVIES_DATASET_REVENUE,
    KaggleDatasetID.REG_SPORTS_NBA_DRAFT_VALUE_OVER_REPLACEMENT,
    OpenMLDatasetID.REG_HOUSES_CALIFORNIA_PRICES_2020,
    OpenMLDatasetID.MUL_CONSUMER_WOMEN_ECOMMERCE_CLOTHING_REVIEW,
    KaggleDatasetID.MUL_FOOD_MICHELIN_GUIDE_RESTAURANTS,
    KaggleDatasetID.REG_FOOD_WINE_POLISH_MARKET_PRICES,
    OpenMLDatasetID.MUL_PROFESSIONAL_DATA_SCIENTIST_SALARY,
    UrlDatasetID.REG_CONSUMER_BABIES_R_US_PRICES,
    OpenMLDatasetID.REG_SPORTS_FIFA22_WAGES,
    KaggleDatasetID.REG_FOOD_ALCOHOL_WIKILIQ_PRICES,
    KaggleDatasetID.REG_FOOD_CHOCOLATE_BAR_RATINGS,
    UrlDatasetID.REG_SOCIAL_BOOKS_GOODREADS,
    OpenMLDatasetID.BIN_SOCIAL_JIGSAW_TOXICITY,
    KaggleDatasetID.REG_FOOD_WINE_VIVINO_SPAIN,
    KaggleDatasetID.REG_FOOD_COFFEE_REVIEW,
    KaggleDatasetID.REG_TRANSPORTATION_USED_CAR_MERCEDES_BENZ_ITALY,
    UrlDatasetID.REG_PROFESSIONAL_ML_DS_AI_JOBS_SALARIES,
    KaggleDatasetID.REG_SOCIAL_MUSEUMS_US_REVENUES,
    OpenMLDatasetID.MUL_FOOD_WINE_REVIEW,
    OpenMLDatasetID.BIN_SOCIAL_IMDB_GENRE_PREDICTION,
    OpenMLDatasetID.REG_CONSUMER_BOOK_PRICE_PREDICTION,
    OpenMLDatasetID.REG_CONSUMER_MERCARI_ONLINE_MARKETPLACE,
    UrlDatasetID.REG_PROFESSIONAL_EMPLOYEE_RENUMERATION_VANCOUBER,
    KaggleDatasetID.REG_PROFESSIONAL_COMPANY_EMPLOYEES_SIZE,
    KaggleDatasetID.REG_SOCIAL_KOREAN_DRAMA,
    KaggleDatasetID.REG_TRANSPORTATION_USED_CAR_SAUDI_ARABIA,
    OpenMLDatasetID.BIN_PROFESSIONAL_FAKE_JOB_POSTING,
    KaggleDatasetID.REG_SOCIAL_SPOTIFY_POPULARITY,
    KaggleDatasetID.MUL_FOOD_YELP_REVIEWS,
    KaggleDatasetID.REG_FOOD_BEER_RATINGS,
    KaggleDatasetID.MUL_TRANSPORTATION_US_ACCIDENTS_MARCH23,
    UrlDatasetID.REG_PROFESSIONAL_SCIMAGOJR_ACADEMIC_IMPACT,
]

NUM_FOLDS = 5

def get_downstream_fold(k: int, folds: int = NUM_FOLDS) -> List[TabularDatasetID]:
    dataset2fold = get_dataset2fold(folds=folds)
    return [d for d, i in dataset2fold.items() if i == k]

def get_dataset2fold(folds: int = NUM_FOLDS) -> dict:
    dataset2fold = {d: i % folds for i, d in enumerate(ALL_TEXT_SHUFFLED)}
    return dataset2fold


